/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE. 
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*******************************************************************************
 *
 * Filename:
 * ---------
 * widget_extension.h
 *
 * Project:
 * --------
 * MAUI
 *
 * Description:
 * ------------
 * Prototypes & MACRO of widget library extension 
 *
 * Author:
 * -------
 * -------
 *
 *==============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!! 
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!! 
 *==============================================================================
 *******************************************************************************/

#ifndef _WIDGET_EXTENSION_H
#define _WIDGET_EXTENSION_H

#include "conversions.h" 
#ifndef _msf_int_h
#error "msf_int.h should be included"
#endif 

#include "ctk.h"

#include "wap_cmn.h"     /* Failsafe. To be removed in the future */


/* for switch widget screen */
#define WAP_GOBACK_WIDGET_SCREEN    (0x1000)
#define WAP_LEAVE_WIDGET_SCREEN     (0x1001)


/* Basic types */
typedef ctk_string_id widget_string_id;
typedef ctk_image_id widget_image_id;
typedef int (*MsfFormAudioCallBack)(void);

typedef enum
{
    WIDGET_STRING_PACK_ID,
    WIDGET_STRING_PACK_UCS2,
    WIDGET_STRING_PACK_UTF8
} widget_string_pack_enum;

typedef struct
{
    widget_string_pack_enum type;
    union
    {
        ctk_string_id id;
        kal_uint8 *ucs2;
        kal_uint8 *utf8;
    } _u;
} widget_string_pack_struct;


extern int HDIa_widgetWindowGetProperties(MsfWindowHandle window);

extern kal_bool HDIa_widgetExtIsCurrentFocusedPaintbox(void);

extern MSF_UINT8 widget_is_paintbox_focused(void);

#ifdef WAP_USE_ASM
extern void widget_asm_wap_deinit(void);
extern void HDIa_widgetExtCloseASMTransitionAnimation(void);
extern void HDIa_widgetExtDisplayASMTransitionAnimation(void);
#endif
extern void widget_deregister_paintbox_on_top_callback(void);
extern kal_bool widget_is_paintbox_on_top(void);

extern void HDIa_widgetExtCloseWAPTransitionAnimation(void);

extern int HDIa_widgetExtPaintboxInputFocus(MsfGadgetHandle handle);
extern int HDIa_widgetGetSystemFontSize(void);  /* Deprecated */
extern int HDIa_widgetExtGetInputboxWidthBySize(MsfBrushHandle handle, int char_cnt, kal_bool is_passwd);

extern void HDIa_widgetExtActionSetText(MsfActionHandle action, MsfStringHandle label);


#ifdef WIDGET_PRECACHE_IMAGE
extern void HDIa_widgetExtEnablePreCacheImage(MsfImageHandle img);
#endif 

extern void HDIa_widgetExtPaintDirectly(void);

extern void HDIa_widgetExtDisplayTransitionAnimation(kal_bool is_MMS);
extern void HDIa_widgetExtDisplayTransitionAnimationNoEnd(kal_bool is_MMS);
extern void HDIa_widgetExtCloseTransitionAnimation(void);


typedef int (*MsfMenuExtHighlightHandle)(MsfWindowHandle menu, int index);

extern U8 HDIa_widgetExtMsfToMMIImageFormat(MsfImageFormat format);
extern const char *HDIa_widgetExtImageGadgetGetSourceFile(MsfGadgetHandle handle);
extern const char* HDIa_widgetExtGetImageContentFile(MsfImageHandle image);

/*
 * System-related
 */
extern void widget_send_update_event_to_wap(void);

extern U8 widget_is_shutdown_UI(void);


extern void widget_MMI_delete_symbol_picker_screen_if_present(void);
extern void widget_MMI_delete_editor_options_screen(void);

/* NEW POPUP */
extern int HDIa_widgetExtShowPopup(MSF_UINT8 modId, MsfStringHandle dialogText, MsfDialogType type, int timeout);
extern int HDIa_widgetExtShowPopupWithType(MSF_UINT8 modId, MsfStringHandle dialogText, MsfDialogType type);
extern int HDIa_widgetExtShowPopupExt(
            MSF_UINT8 modId,
            MsfStringHandle dialogText,
            ctk_image_id imageid,
            ctk_tone_id toneid,
            kal_bool imageOnBottom);

extern void HDIa_widgetExtDisplayTransitionAnimationWithTime(MSF_UINT8 modId, MsfStringHandle dialogText, int timeout);
extern void HDIa_widgetExtStopDialogTone(void);

extern void HDIa_widgetExtWAPDeleteEditorScreens(void);

extern void HDIa_widgetExtShowConfirm(MsfWindowHandle dialog, MsfStringHandle dialogText);
extern void HDIa_widgetExtCloseConfirm(void);

/* 
 * Sound 
 */

#ifdef WIDGET_SUPPORT_SOUND
extern int HDIa_widgetExtSoundPlayOnWindow(MsfSoundHandle sound, MsfWindowHandle wnd);
#endif /* WIDGET_SUPPORT_SOUND */
extern int HDIa_widgetExtSoundGetDuration(void* file_name, kal_uint32 *duration);

extern int HDIa_widgetExtIsSoundPlaying(void);

/*
 * Image Resizing
 */
#define MSF_WIDGET_EXT_RESIZING_SUCCEED                                         (1)
#define MSF_WIDGET_EXT_RESIZING_SUCCEED_WITH_UNCHANGED                          (0)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_GDI_FAILED                            (-1)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_GDI_ENCODER_ERR_DISK_FULL             (-5)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_GDI_ENCODER_ERR_WRITE_PROTECTION      (-6)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_GDI_ENCODER_ERR_NO_DISK               (-7)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_NO_QUOTA                              (-10)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_UNKNOWN_DIMENSION                     (-11)
#define MSF_WIDGET_EXT_RESIZING_FAILED_IN_INSUFFICIENT_DRAWING_BUF              (-12)



extern void HDIa_widgetExtRegisterUrgentServiceLoading(kal_bool show_popup,MSF_UINT32 sim_info);															
extern void HDIa_widgetExtClearUrgentServiceLoading(void);
extern void HDIa_widgetExtRegisterUrgentServiceIndication(kal_bool show_popup,MSF_UINT32 sim_info);											
extern void HDIa_widgetExtClearUrgentServiceIndication(void);

extern void HDIa_widgetExtRegisterDRMRightNotification(MsfStringHandle dialogText, MsfDialogType type);
extern void HDIa_widgetExtClearDRMRightNotification(void);

/* 
 * Adaptation to CTK 
 */
extern void HDIa_widgetCtkSetOnPostPaint(MsfWindowHandle wnd, void (*callback) (void));

#ifdef OBIGO_Q03C_MMS_V01
extern MsfWindowHandle HDIa_widgetCtkGetWindow(ctk_screen_handle scrid);
extern ctk_screen_handle HDIa_widgetCtkGetScreenHandle(MsfWindowHandle wnd);
#endif /* OBIGO_Q03C_MMS_V01 */

#define WIDGET_CTK_FLAG_DISABLE_SLIM_MENU_STYLE (0x0001)
#define WIDGET_CTK_FLAG_BACKLIGHT_ALWAYS_ON     (0x0002)
#define WIDGET_CTK_SMIL_EDITOR_USING_SCRN_MEM   (0x0004)
typedef kal_uint16 widget_ctk_flag_t;
extern void HDIa_widgetCtkSetFlag(MsfWindowHandle ctk, widget_ctk_flag_t flags);
extern void HDIa_widgetCtkUnsetFlag(MsfWindowHandle ctk, widget_ctk_flag_t flags);

/* 
 * File manager integration
 */

typedef void (*widget_fmgr_input_callback) (const char *pathname, void *arg);

typedef void (*widget_fmgr_filename_callback) (const char *pathname, void *arg);





/* List Menu (Dynamic) */
typedef void (*widget_list_menu_callback) (int index, void *arg, kal_uint8 *string, int string_size,
                                           ctk_image_id *img);
typedef void (*widget_list_menu_hint_callback) (int index, void *arg, kal_uint8 *hint, int hint_size);

/* Choice Menu (Dynamic) */
typedef kal_uint8 *(*widget_radio_menu_callback) (void *arg, int index);


/* Extension to MsfChioceElement */
#define WIDGET_EXT_CHOICE_ELEM_NO_RIGHT_ARROW   (0x01)

extern int HDIa_widgetExtChoiceUnsetElemFlag(MSF_UINT32 choice, int index, MSF_UINT8 flag);
extern int HDIa_widgetExtChoiceGetFocusedElemFlags(MSF_UINT32 choice, MSF_UINT8 *flags);

/* Extension of gadget property */
#define MSF_GADGET_PROPERTY_EXT_CLEAN_DISPLAY_AREA          (0x00100000)


/* Extension of window property */
#define MSF_WINDOW_PROPERTY_EXT_DISABLE_RIGHT_ARROW         (0x00100000)    /* For MsfMenu */
#define MSF_WINDOW_PROPERTY_EXT_VOLUME_KEY                  (0x00200000)    /* For MsfForm */
#define MSF_WINDOW_PROPERTY_EXT_STATUS_ICON                 (0x00400000)    /* For MsfDialog */
#define MSF_WINDOW_PROPERTY_EXT_DISBALE_SLIM_MENU_STYLE     (0x00800000)    /* For MsfMenu */
#define MSF_WINDOW_PROPERTY_EXT_IS_MESSAGE_APPLICATION      (0x01000000)    /* For MsfMenu */

/* Extension of MsfActionType */
#define MsfWidgetUsing      (1<<16)

/* Extension of MsfDialogType */
typedef enum
{
    MsfPromptEmpty = 30,
    MsfPromptSaveDone,   /* Saved or Done */
    MsfUnfinishedError    /* Unfinished popup string for no exceed from certain limit */
} MsfDialogTypeExt;

/* Extension of MsfTextType */
typedef enum
{
    MsfSaveAsFilename = 50, /* posix characters + chinese.  '.' is also disallowed */
    MsfMMIDefaultInputMethod,
    MsfUpperCase,
    MsfPhoneNumberOrEmail   /* Deprecated */
} MsfTextTypeExt;

#define MsfUnsupportedMediaType  0xC0

/* Extension of MsfStringFormat */
typedef enum
{
    MsfUcs2 = MsfUtf8 + 10
        /* MsfAscii */
} MsfStringFormatExt;

/* Extension of MsfResourceType */
typedef enum
{
    MsfResourcePartialFile = 0x80
#ifdef __DRM_SUPPORT__
        , MsfResourceDRMFile = 0x81
#endif 
} MsfResourceTypeExt;

/* Extension of MsfNotificationType */
typedef enum
{
    MsfNotifyResourceError = MsfNotifyResourceFailed,
    MsfNotifyResourceReady = MsfNotifyResourceLoaded,

    MsfNotifyFailedResolution = 0x80,
    MsfNotifyFailedFSFull,
    MsfNotifyFailedNoResource,
    MsfNotifyFailedCorrupt,
    MsfNotifyFailedADMFULL
} MsfNotificationTypeExt;

typedef struct
{
    char *filename;
    int start_offset;
    int data_size;
} MsfPartialFileData;


typedef enum
{
    
    WIDGET_CHSET_BASE = MMI_CHSET_BASE,    
    WIDGET_CHSET_ARABIC_ISO = MMI_CHSET_ARABIC_ISO,    
    WIDGET_CHSET_ARABIC_WIN = MMI_CHSET_ARABIC_WIN,    
    WIDGET_CHSET_PERSIAN_CP1097 = MMI_CHSET_PERSIAN_CP1097,    
    WIDGET_CHSET_PERSIAN_CP1098 = MMI_CHSET_PERSIAN_CP1098,    
    WIDGET_CHSET_BALTIC_ISO = MMI_CHSET_BALTIC_ISO,    
    WIDGET_CHSET_BALTIC_WIN = MMI_CHSET_BALTIC_WIN,    
    WIDGET_CHSET_CEURO_ISO = MMI_CHSET_CEURO_ISO,    
    WIDGET_CHSET_CEURO_WIN = MMI_CHSET_CEURO_WIN,    
    WIDGET_CHSET_GREEK_ISO = MMI_CHSET_GREEK_ISO,    
    WIDGET_CHSET_GREEK_WIN = MMI_CHSET_GREEK_WIN,    
    WIDGET_CHSET_HEBREW_ISO = MMI_CHSET_HEBREW_ISO,    
    WIDGET_CHSET_HEBREW_WIN = MMI_CHSET_HEBREW_WIN,    
    WIDGET_CHSET_LATIN_ISO = MMI_CHSET_LATIN_ISO,   
    WIDGET_CHSET_NORDIC_ISO = MMI_CHSET_NORDIC_ISO,    
    WIDGET_CHSET_SEURO_ISO = MMI_CHSET_SEURO_ISO,    
    WIDGET_CHSET_TURKISH_ISO = MMI_CHSET_TURKISH_ISO,    
    WIDGET_CHSET_TURKISH_WIN = MMI_CHSET_TURKISH_WIN,    
    WIDGET_CHSET_WESTERN_ISO = MMI_CHSET_WESTERN_ISO,  
    WIDGET_CHSET_ARMENIAN_ISO  = MMI_CHSET_ARMENIAN_ISO,    
    WIDGET_CHSET_WESTERN_WIN = MMI_CHSET_WESTERN_WIN,
    /* Add new (8-bit) encodings above this line */
    WIDGET_CHSET_8_BITS_END,    
    WIDGET_CHSET_BIG5 = MMI_CHSET_BIG5,    
    WIDGET_CHSET_GB2312 = MMI_CHSET_GB2312,   
    WIDGET_CHSET_SJIS = MMI_CHSET_SJIS,    
    WIDGET_CHSET_GB18030 = MMI_CHSET_GB18030,    
    WIDGET_CHSET_UTF7 = MMI_CHSET_UTF7,    
    WIDGET_CHSET_EUCKR = MMI_CHSET_EUCKR,    
    WIDGET_CHSET_THAI_WIN = MMI_CHSET_THAI_WIN,    
    WIDGET_CHSET_VIETNAMESE_WIN = MMI_CHSET_VIETNAMESE_WIN,    
    WIDGET_CHSET_KOI8_R = MMI_CHSET_KOI8_R,
    WIDGET_CHSET_TIS_620 = MMI_CHSET_TIS_620,
    WIDGET_CHSET_TOTAL
} widget_chset_enum;

extern kal_bool HDIa_widgetExtEncXToUTF8(
                     const kal_uint8 *src, 
                     kal_int32 *srcLen,
                     kal_uint8 *dst,
                     kal_int32 *dstLen,
                     widget_chset_enum charset);
kal_bool HDIa_widgetExtUTF8ToEncX(
                     const kal_uint8 *src, 
                     kal_int32 *srcLen,
                     kal_uint8 *dst, 
                     kal_int32 *dstLen,  
                     widget_chset_enum charset);
/* Additional encoding conversion */
extern kal_bool HDIa_widgetExtBig5ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToBig5(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtGB2312ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToGB2312(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtHKSCSToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToHKSCS(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
/* ISO-8859-1  */          
extern kal_bool HDIa_widgetExtISO_8859_1ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_1(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
                    
/* ISO-8859-3 */          
extern kal_bool HDIa_widgetExtISO_8859_3ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_3(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
      
/* ISO-8859-4 */  
extern kal_bool HDIa_widgetExtISO_8859_4ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_4(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);

      
/* ISO-8859-5 */  
extern kal_bool HDIa_widgetExtISO_8859_5ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_5(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);

/* ISO-8859-6 */  
extern kal_bool HDIa_widgetExtISO_8859_6ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_6(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
/* ISO-8859-7 */  
extern kal_bool HDIa_widgetExtISO_8859_7ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_7(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);

/* ISO-8859-9 */  
extern kal_bool HDIa_widgetExtISO_8859_9ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_9(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
/* ISO-8859-10 */  
extern kal_bool HDIa_widgetExtISO_8859_10ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToISO_8859_10(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);




extern kal_bool HDIa_widgetExtGB18030ToUTF8(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);
extern kal_bool HDIa_widgetExtUTF8ToGB18030(
                    const kal_uint8 *src,
                    kal_int32 *srcLen,
                    kal_uint8 *dst,
                    kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtUTF8ToWin1256(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1256ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

/* Window-1250 */
extern kal_bool HDIa_widgetExtUTF8ToWin1250(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1250ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);			
/* Window-1251 */
extern kal_bool HDIa_widgetExtUTF8ToWin1251(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1251ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);		
/* Window-1252 */
extern kal_bool HDIa_widgetExtUTF8ToWin1252(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1252ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
/* Window-1253 */
extern kal_bool HDIa_widgetExtUTF8ToWin1253(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1253ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
/* Window-1254 */
extern kal_bool HDIa_widgetExtUTF8ToWin1254(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1254ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
/* Window-1255 */
extern kal_bool HDIa_widgetExtUTF8ToWin1255(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1255ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
/* Window-1257 */
extern kal_bool HDIa_widgetExtUTF8ToWin1257(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1257ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
/* Window-1258 */
extern kal_bool HDIa_widgetExtUTF8ToWin1258(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);

extern kal_bool HDIa_widgetExtWin1258ToUTF8(
										const kal_uint8 *src,
										kal_int32 *srcLen,
										kal_uint8 *dst,
										kal_int32 *dstLen);										
								




/* UTF8/UCS2 Encoding & String handling */
extern int widget_utf8_length(const kal_uint8 *s);
extern int widget_ucs2_length(const kal_uint8 *s);
extern int widget_ucs2_to_utf8_length_in_bytes(const kal_uint8 *raw);
extern int widget_utf8_to_ucs2_length_in_bytes(const kal_uint8 *raw);

extern int widget_utf8_to_ucs2_string(kal_uint8 *dest, int dest_size, const kal_uint8 *src);
extern int widget_ucs2_to_utf8_string(kal_uint8 *dest, int dest_size, const kal_uint8 *src);

/* Creating an UCS2 string */
extern const kal_uint8 *HDIa_widgetExtStringGetUCS2buffer(MsfStringHandle str);
extern const kal_uint8 *msf_StringGetPredefinedUCS2buffer(MSF_UINT32 resid);    //MMS_ONLY_BUILD

extern kal_uint8 *widget_ucs2_strcpy(kal_uint8 *dst, const kal_uint8 *src);
extern kal_uint8 *widget_ucs2_strncpy(kal_uint8 *dst, const kal_uint8 *src, int size);

extern kal_uint8 *widget_ucs2_strdup(MSF_UINT8 modId, const kal_uint8 *str);
extern kal_uint8 *widget_ucs2_strdup_from_utf8(MSF_UINT8 modId, const kal_uint8 *str);
extern kal_uint8 *widget_ucs2str_append_utf8(
                    MSF_UINT8 modId,
                    kal_uint8 *src,
                    int *allocated_size,
                    const kal_uint8 *add_utf8_str);
extern kal_uint8 *widget_ucs2str_append_ucs2(
                    MSF_UINT8 modId,
                    kal_uint8 *src,
                    int *allocated_size,
                    const kal_uint8 *add_ucs2_str);
extern kal_uint8 *widget_ucs2str_append_handle(
                    MSF_UINT8 modId,
                    kal_uint8 *src,
                    int *allocated_size,
                    MsfStringHandle stringHandle);
extern kal_uint8 *widget_ucs2str_append_id(MSF_UINT8 modId, kal_uint8 *src, int *allocated_size, int strid);

extern ctk_image_id widget_get_title_icon(ctk_image_id imageid);

/* WAP status bar */
#ifdef WIDGET_DRAW_STATUS_BAR
extern void widget_enable_status_bar(int indicator);
extern void widget_disable_status_bar(int indicator);

/* Typically used by WAP, not by MMS (except for sound indication) */
#define WIDGET_STATUS_BAR_BUSY              (1<<0)        /* Data trasmitting/receiving (Set by application) */
#define WIDGET_STATUS_BAR_CSD               (1<<1)        /* The following four types are set by widget itself */
#define WIDGET_STATUS_BAR_GPRS              (1<<2)
#define WIDGET_STATUS_BAR_WIFI              (1<<3)
#define WIDGET_STATUS_BAR_DISCONNECT        (1<<4)
#define WIDGET_STATUS_BAR_SECURITY          (1<<5)
#define WIDGET_STATUS_BAR_SOUND_IND         (1<<6)        /* Used by MMS to indicate the sound is playing */
/* WIDGET_MMS_STATUS_BAR are used with BUSY CSD GPRS DISCONNECT */
#endif /* WIDGET_DRAW_STATUS_BAR */


/* Handling UCS2 string not aligned with 2 bytes. (Obigo adopts UTF8 by default) */
#ifndef CAST_PU8
#define CAST_PU8(RAW)   ((kal_uint8*)(RAW))
#endif
#ifndef CAST_CPU8
#define CAST_CPU8(RAW)  ((const kal_uint8*)(RAW))
#endif
#ifndef GET_U8_BYTE_TO_U16
#define GET_U8_BYTE_TO_U16(RAW, i)  ((kal_uint16)(CAST_CPU8(RAW)[i]))
#endif

#ifndef STR_SIZE
#define STR_SIZE(len) ((len)<<1)
#endif
#ifndef STR_AT
#define STR_AT(RAW, n) ((void*)(CAST_PU8(RAW)+STR_SIZE(n)))
#endif
#ifndef CHR_AT
#define CHR_AT(RAW, n) ((kal_uint16)(GET_U8_BYTE_TO_U16(RAW, STR_SIZE(n))+(GET_U8_BYTE_TO_U16(RAW, STR_SIZE(n)+1)<<8)))
#endif
#ifndef SET_CHR_AT
#define SET_CHR_AT(RAW, n, value)   do {                          \
                              kal_uint8 *_p = STR_AT(RAW, n);     \
                              kal_uint16 v= (kal_uint16) (value); \
                              _p[0] = (kal_uint8) (v & 0xff);     \
                              _p[1] = (kal_uint8) (v >> 8);       \
                           } while (0)
#endif
#ifndef CHR
#define CHR(x)      ((kal_uint16)(x))
#endif

#define STR_LEN(RAW)  widget_ucs2_length(CAST_CPU8(RAW))


typedef enum
{
    MsfVideoFormatStart = 0x40,
    Msf3gp,
    MsfMp4,
    MsfAvi,
    MsfRm,
    MsfRv,
    MsfRmvb
} MsfVideoFormat;

/* Query functions for NMGR */
extern void HDIa_widgetResetRenderingFlags(void);
/* Check if window is being shown */
extern MsfWindowHandle HDIa_widgetExtGetCurrentWindow(MsfScreenHandle screen);
extern void widget_is_phone_lock(void *ret);

/* If we want to enable WAP_DBG_ASSERT and WAP_RST_ASSERT, we need to change 0 to 1. */
#define WAP_DBG_ASSERT(_expr) {if(0) ASSERT(_expr);}
#define WAP_RST_ASSERT(_expr) {if(!(_expr)) {if (0) {ASSERT(0);} else {wap_restart_task();}}}
 
#endif /* _WIDGET_EXTENSION_H */ 

